<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\andre\Source\School\BDSA2021-FinalProject\WebService.Entities\Context.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
// ***********************************************************************
// Assembly         : WebService.Entities
// Author           : Group BTG
// Created          : 11-29-2021
//
// Last Modified By : Group BTG
// Last Modified On : 12-14-2021
// ***********************************************************************
// &lt;copyright file=&quot;Context.cs&quot; company=&quot;BTG&quot;&gt;
//     Copyright (c) . All rights reserved.
// &lt;/copyright&gt;
// &lt;summary&gt;&lt;/summary&gt;
// ***********************************************************************

namespace WebService.Entities;

/// &lt;summary&gt;
///     Class Context.
///     Implements the &lt;see cref=&quot;Microsoft.EntityFrameworkCore.DbContext&quot; /&gt;
///     Implements the &lt;see cref=&quot;WebService.Entities.IContext&quot; /&gt;
/// &lt;/summary&gt;
/// &lt;seealso cref=&quot;Microsoft.EntityFrameworkCore.DbContext&quot; /&gt;
/// &lt;seealso cref=&quot;WebService.Entities.IContext&quot; /&gt;
public class Context : DbContext, IContext
{
    /// &lt;summary&gt;
    ///     Initializes a new instance of the &lt;see cref=&quot;Context&quot; /&gt; class.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;options&quot;&gt;The options for this context.&lt;/param&gt;
    /// &lt;remarks&gt;
    ///     See &lt;see href=&quot;https://aka.ms/efcore-docs-dbcontext&quot;&gt;DbContext lifetime, configuration, and initialization&lt;/see&gt;
    ///     and
    ///     &lt;see href=&quot;https://aka.ms/efcore-docs-dbcontext-options&quot;&gt;Using DbContextOptions&lt;/see&gt; for more information.
    /// &lt;/remarks&gt;
    public Context(DbContextOptions options) : base(options)
    {
    }

    /// &lt;summary&gt;
    ///     Gets languages.
    /// &lt;/summary&gt;
    /// &lt;value&gt;The languages.&lt;/value&gt;
    public DbSet&lt;Language&gt; Languages =&gt; Set&lt;Language&gt;();

    /// &lt;summary&gt;
    ///     Gets levels.
    /// &lt;/summary&gt;
    /// &lt;value&gt;The levels.&lt;/value&gt;
    public DbSet&lt;Level&gt; Levels =&gt; Set&lt;Level&gt;();

    /// &lt;summary&gt;
    ///     Gets materials.
    /// &lt;/summary&gt;
    /// &lt;value&gt;The materials.&lt;/value&gt;
    public DbSet&lt;Material&gt; Materials =&gt; Set&lt;Material&gt;();

    /// &lt;summary&gt;
    ///     Gets medias.
    /// &lt;/summary&gt;
    /// &lt;value&gt;The medias.&lt;/value&gt;
    public DbSet&lt;Media&gt; Medias =&gt; Set&lt;Media&gt;();

    /// &lt;summary&gt;
    ///     Gets programming languages.
    /// &lt;/summary&gt;
    /// &lt;value&gt;The programming languages.&lt;/value&gt;
    public DbSet&lt;ProgrammingLanguage&gt; ProgrammingLanguages =&gt; Set&lt;ProgrammingLanguage&gt;();

    /// &lt;summary&gt;
    ///     Gets tags.
    /// &lt;/summary&gt;
    /// &lt;value&gt;The tags.&lt;/value&gt;
    public DbSet&lt;Tag&gt; Tags =&gt; Set&lt;Tag&gt;();

    /// &lt;summary&gt;
    ///     Override this method to further configure the model that was discovered by convention from the entity types
    ///     exposed in &lt;see cref=&quot;T:Microsoft.EntityFrameworkCore.DbSet`1&quot; /&gt; properties on your derived context. The resulting
    ///     model may be cached
    ///     and re-used for subsequent instances of your derived context.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;modelBuilder&quot;&gt;
    ///     The builder being used to construct the model for this context. Databases (and other extensions) typically
    ///     define extension methods on this object that allow you to configure aspects of the model that are specific
    ///     to a given database.
    /// &lt;/param&gt;
    /// &lt;remarks&gt;
    ///     &lt;para&gt;
    ///         If a model is explicitly set on the options for this context (via
    ///         &lt;see
    ///             cref=&quot;M:Microsoft.EntityFrameworkCore.DbContextOptionsBuilder.UseModel(Microsoft.EntityFrameworkCore.Metadata.IModel)&quot; /&gt;
    ///         )
    ///         then this method will not be run.
    ///     &lt;/para&gt;
    ///     &lt;para&gt;
    ///         See &lt;see href=&quot;https://aka.ms/efcore-docs-modeling&quot;&gt;Modeling entity types and relationships&lt;/see&gt; for more
    ///         information.
    ///     &lt;/para&gt;
    /// &lt;/remarks&gt;
    protected override void OnModelCreating(ModelBuilder modelBuilder)
    {
        modelBuilder.Entity&lt;Language&gt;()
            .HasIndex(s =&gt; s.Name)
            .IsUnique();

        modelBuilder.Entity&lt;Level&gt;()
            .HasIndex(s =&gt; s.Name)
            .IsUnique();

        modelBuilder.Entity&lt;Material&gt;()
            .HasIndex(s =&gt; s.Title)
            .IsUnique();

        modelBuilder.Entity&lt;Material&gt;()
            .OwnsMany(e =&gt; e.WeightedTags, a =&gt;
            {
                a.WithOwner().HasForeignKey(&quot;MaterialId&quot;);
                a.Property&lt;int&gt;(&quot;MaterialId&quot;);
                a.Property&lt;string&gt;(&quot;Name&quot;);
                a.HasKey(&quot;MaterialId&quot;, &quot;Name&quot;);
            });

        modelBuilder.Entity&lt;Material&gt;()
            .OwnsMany(e =&gt; e.Ratings, a =&gt;
            {
                a.WithOwner().HasForeignKey(&quot;MaterialId&quot;);
                a.Property&lt;int&gt;(&quot;MaterialId&quot;);
                a.Property&lt;string&gt;(&quot;Reviewer&quot;);
                a.HasKey(&quot;MaterialId&quot;, &quot;Reviewer&quot;);
            });

        modelBuilder.Entity&lt;Material&gt;()
            .OwnsMany(e =&gt; e.Authors, a =&gt;
            {
                a.WithOwner().HasForeignKey(&quot;MaterialId&quot;);
                a.Property&lt;int&gt;(&quot;MaterialId&quot;);
                a.Property&lt;string&gt;(&quot;FirstName&quot;);
                a.Property&lt;string&gt;(&quot;SurName&quot;);
                a.HasKey(&quot;MaterialId&quot;, &quot;FirstName&quot;, &quot;SurName&quot;);
            });

        modelBuilder.Entity&lt;Media&gt;()
            .HasIndex(s =&gt; s.Name)
            .IsUnique();

        modelBuilder.Entity&lt;ProgrammingLanguage&gt;()
            .HasIndex(s =&gt; s.Name)
            .IsUnique();

        modelBuilder.Entity&lt;Tag&gt;()
            .HasIndex(s =&gt; s.Name)
            .IsUnique();
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[35,48,35,61,1],[36,5,36,6,1],[37,5,37,6,1],[43,41,43,56,1],[49,35,49,47,1],[55,41,55,56,1],[61,35,61,47,1],[67,63,67,89,1],[73,31,73,41,1],[100,5,100,6,1],[101,9,103,25,1],[105,9,107,25,1],[109,9,111,25,1],[113,9,115,13,1],[115,13,115,14,1],[115,14,116,17,1],[116,17,116,59,1],[116,59,117,17,1],[117,17,117,47,1],[117,47,118,17,1],[118,17,118,44,1],[118,44,119,17,1],[119,17,119,48,1],[119,48,120,13,1],[120,13,120,14,1],[120,14,120,16,1],[122,9,124,13,1],[124,13,124,14,1],[124,14,125,17,1],[125,17,125,59,1],[125,59,126,17,1],[126,17,126,47,1],[126,47,127,17,1],[127,17,127,48,1],[127,48,128,17,1],[128,17,128,52,1],[128,52,129,13,1],[129,13,129,14,1],[129,14,129,16,1],[131,9,133,13,1],[133,13,133,14,1],[133,14,134,17,1],[134,17,134,59,1],[134,59,135,17,1],[135,17,135,47,1],[135,47,136,17,1],[136,17,136,49,1],[136,49,137,17,1],[137,17,137,47,1],[137,47,138,17,1],[138,17,138,64,1],[138,64,139,13,1],[139,13,139,14,1],[139,14,139,16,1],[141,9,143,25,1],[145,9,147,25,1],[149,9,151,25,1],[152,5,152,6,1]]);
    </script>
  </body>
</html>