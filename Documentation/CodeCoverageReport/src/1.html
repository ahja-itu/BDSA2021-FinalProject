<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\andre\Source\School\BDSA2021-FinalProject\WebService.Core.Shared.Tests\MaterialDTOTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
// ***********************************************************************
// Assembly         : WebService.Core.Shared.Tests
// Author           : Group BTG
// Created          : 12-08-2021
//
// Last Modified By : Group BTG
// Last Modified On : 12-14-2021
// ***********************************************************************
// &lt;copyright file=&quot;MaterialDTOTests.cs&quot; company=&quot;BTG&quot;&gt;
//     Copyright (c) . All rights reserved.
// &lt;/copyright&gt;
// &lt;summary&gt;&lt;/summary&gt;
// ***********************************************************************

using System;
using System.Collections.Generic;
using System.Globalization;
using System.Linq;
using WebService.Entities;
using Xunit;

namespace WebService.Core.Shared.Tests;

/// &lt;summary&gt;
///     Class MaterialDTOTests.
/// &lt;/summary&gt;
public class MaterialDTOTests
{
    /// &lt;summary&gt;
    ///     The material
    /// &lt;/summary&gt;
    private readonly Material _material;

    /// &lt;summary&gt;
    ///     Initializes a new instance of the &lt;see cref=&quot;MaterialDTOTests&quot; /&gt; class.
    /// &lt;/summary&gt;
    public MaterialDTOTests()
    {
        _material = new Material(
            0,
            new List&lt;WeightedTag&gt;
            {
                new(0, &quot;weigthedtag0&quot;, 2),
                new(1, &quot;weigthedtag1&quot;, 10)
            },
            new List&lt;Rating&gt;
            {
                new(0, 7, &quot;reviewer0&quot;),
                new(1, 6, &quot;reviewer1&quot;),
                new(2, 10, &quot;reviewer2&quot;),
                new(3, 9, &quot;reviewer3&quot;),
                new(4, 7, &quot;reviewer4&quot;),
                new(5, 8, &quot;reviewer5&quot;)
            },
            new List&lt;Level&gt;
            {
                new(0, &quot;Level0&quot;),
                new(1, &quot;Level1&quot;),
                new(2, &quot;level2&quot;)
            },
            new List&lt;ProgrammingLanguage&gt;
            {
                new(0, &quot;ProgrammingLanguage0&quot;),
                new(1, &quot;ProgrammingLanguage0&quot;)
            },
            new List&lt;Media&gt;
            {
                new(0, &quot;Media0&quot;),
                new(1, &quot;Media1&quot;)
            },
            new Language(0, &quot;language&quot;),
            &quot;Summary&quot;,
            &quot;URL.com&quot;,
            &quot;Content&quot;,
            &quot;Title&quot;,
            new List&lt;Author&gt;
            {
                new(0, &quot;firstname0&quot;, &quot;surname0&quot;),
                new(0, &quot;firstname1&quot;, &quot;surname1&quot;)
            },
            DateTime.ParseExact(&quot;2011-03-21 13:26&quot;, &quot;yyyy-MM-dd HH:mm&quot;, CultureInfo.InvariantCulture)
        );
    }

    /// &lt;summary&gt;
    ///     Defines the test method ConvertToMaterialDTOReturnsIdenticalMaterialDTO.
    /// &lt;/summary&gt;
    [Fact]
    public void ConvertToMaterialDTOReturnsIdenticalMaterialDTO()
    {
        var expected = new MaterialDTO(
            0,
            new List&lt;CreateWeightedTagDTO&gt;
            {
                new WeightedTagDTO(&quot;weigthedtag0&quot;, 2),
                new WeightedTagDTO(&quot;weigthedtag1&quot;, 10)
            },
            new List&lt;CreateRatingDTO&gt;
            {
                new RatingDTO(0, 7, &quot;reviewer0&quot;),
                new RatingDTO(1, 6, &quot;reviewer1&quot;),
                new RatingDTO(2, 10, &quot;reviewer2&quot;),
                new RatingDTO(3, 9, &quot;reviewer3&quot;),
                new RatingDTO(4, 7, &quot;reviewer4&quot;),
                new RatingDTO(5, 8, &quot;reviewer5&quot;)
            },
            new List&lt;CreateLevelDTO&gt;
            {
                new LevelDTO(0, &quot;Level0&quot;),
                new LevelDTO(1, &quot;Level1&quot;),
                new LevelDTO(2, &quot;level2&quot;)
            },
            new List&lt;CreateProgrammingLanguageDTO&gt;
            {
                new ProgrammingLanguageDTO(0, &quot;ProgrammingLanguage0&quot;),
                new ProgrammingLanguageDTO(1, &quot;ProgrammingLanguage0&quot;)
            },
            new List&lt;CreateMediaDTO&gt;
            {
                new MediaDTO(0, &quot;Media0&quot;),
                new MediaDTO(1, &quot;Media1&quot;)
            },
            new CreateLanguageDTO(&quot;language&quot;),
            &quot;Summary&quot;,
            &quot;URL.com&quot;,
            &quot;Content&quot;,
            &quot;Title&quot;,
            new List&lt;CreateAuthorDTO&gt;
            {
                new AuthorDTO(&quot;firstname0&quot;, &quot;surname0&quot;),
                new AuthorDTO(&quot;firstname1&quot;, &quot;surname1&quot;)
            },
            DateTime.ParseExact(&quot;2011-03-21 13:26&quot;, &quot;yyyy-MM-dd HH:mm&quot;, CultureInfo.InvariantCulture)
        );
        var actual = _material.ConvertToMaterialDTO();

        Assert.Equal(expected.Id, actual.Id);
        Assert.Equal(expected.Tags, actual.Tags);

        Assert.Equal(expected.Ratings.Count, actual.Ratings.Count);
        var expectedCounter = (from RatingDTO? expectedRating in expected.Ratings
            from actualRatingDTO1 in actual.Ratings
            let actualRating = (RatingDTO) actualRatingDTO1
            where expectedRating.Id == actualRating.Id &amp;&amp; expectedRating.Value == actualRating.Value &amp;&amp;
                  expectedRating.Reviewer == actualRating.Reviewer &amp;&amp;
                  expectedRating.TimeStamp.ToString(CultureInfo.CurrentCulture) ==
                  actualRating.TimeStamp.ToString(CultureInfo.CurrentCulture)
            select expectedRating).Count();
        Assert.Equal(6, expectedCounter);

        Assert.Equal(expected.Levels, actual.Levels);
        Assert.Equal(expected.ProgrammingLanguages, actual.ProgrammingLanguages);
        Assert.Equal(expected.Medias, actual.Medias);
        Assert.Equal(expected.Language, actual.Language);
        Assert.Equal(expected.Summary, actual.Summary);
        Assert.Equal(expected.Url, actual.Url);
        Assert.Equal(expected.Content, actual.Content);
        Assert.Equal(expected.Title, actual.Title);
        Assert.Equal(expected.Authors, actual.Authors);
        Assert.Equal(expected.TimeStamp.ToString(CultureInfo.CurrentCulture),
            expected.TimeStamp.ToString(CultureInfo.CurrentCulture));
    }

    /// &lt;summary&gt;
    ///     Defines the test method AverageRatingReturns7_8.
    /// &lt;/summary&gt;
    [Fact]
    public void AverageRatingReturns7_8()
    {
        const double expected = 7.833333;

        var actual = _material.ConvertToMaterialDTO().AverageRating();

        Assert.Equal(expected, actual, 5);
    }

    /// &lt;summary&gt;
    ///     Defines the test method LevelsToStringReturnsLevelNamesSeperatedBySpaces.
    /// &lt;/summary&gt;
    [Fact]
    public void LevelsToStringReturnsLevelNamesSeperatedBySpaces()
    {
        const string expected = &quot;Level0 Level1 level2&quot;;

        var actual = _material.ConvertToMaterialDTO().LevelsToString();

        Assert.Equal(expected, actual);
    }

    /// &lt;summary&gt;
    ///     Defines the test method AuthorsToStringReturnFullNamesSeperatedByComma.
    /// &lt;/summary&gt;
    [Fact]
    public void AuthorsToStringReturnFullNamesSeperatedByComma()
    {
        const string expected = &quot;Authors: firstname0 surname0, firstname1 surname1&quot;;

        var actual = _material.ConvertToMaterialDTO().AuthorsToString();

        Assert.Equal(expected, actual);
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[37,5,37,30,1],[38,5,38,6,1],[39,9,82,11,1],[83,5,83,6,1],[90,5,90,6,1],[91,9,134,11,1],[135,9,135,55,1],[137,9,137,46,1],[138,9,138,50,1],[140,9,140,68,1],[141,9,142,13,1],[142,13,142,38,1],[142,38,142,52,1],[142,52,143,32,1],[143,32,143,60,1],[143,60,144,19,1],[144,19,147,78,1],[147,78,148,20,1],[148,20,148,34,1],[148,34,148,44,1],[149,9,149,42,1],[151,9,151,54,1],[152,9,152,82,1],[153,9,153,54,1],[154,9,154,58,1],[155,9,155,56,1],[156,9,156,48,1],[157,9,157,56,1],[158,9,158,52,1],[159,9,159,56,1],[160,9,161,70,1],[162,5,162,6,1],[169,5,169,6,1],[172,9,172,71,1],[174,9,174,43,1],[175,5,175,6,1],[182,5,182,6,1],[185,9,185,72,1],[187,9,187,40,1],[188,5,188,6,1],[195,5,195,6,1],[198,9,198,73,1],[200,9,200,40,1],[201,5,201,6,1]]);
    </script>
  </body>
</html>